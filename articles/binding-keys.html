<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="cohortBuilder">
<title>Specifying data relations with Binding Keys • cohortBuilder</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Specifying data relations with Binding Keys">
<meta property="og:description" content="cohortBuilder">
<meta property="og:image" content="https://r-world-devs.github.io/cohortBuilder/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">cohortBuilder</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9037</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/cohortBuilder.html">
    <span class="fa fa fa fa-thumbs-o-up"></span>
     
    Get started
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">
    <span class="fa fa fa fa-file-code-o"></span>
     
    Functions
  </a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--articles">
    <span class="fa fa fa fa-thumbs-o-up"></span>
     
    Articles
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--articles">
    <a class="dropdown-item" href="../articles/managing-cohort.html">Managing Cohort Object</a>
    <a class="dropdown-item" href="../articles/cohort-configuration.html">Variants for Cohort Configuration</a>
    <a class="dropdown-item" href="../articles/binding-keys.html">Specifying data relations with Binding Keys</a>
    <a class="dropdown-item" href="../articles/custom-filters.html">Implementing custom filters</a>
    <a class="dropdown-item" href="../articles/custom-extensions.html">Writing custom extensions</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">
    <span class="fa fa fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="https://r-world-devs.github.io/cohortBuilder/issues">
    <span class="fa fa fa fa-ambulance"></span>
     
    Issues
  </a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/r-world-devs/shinyGizmo/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Specifying data relations with Binding Keys</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/r-world-devs/shinyGizmo/blob/HEAD/vignettes/binding-keys.Rmd" class="external-link"><code>vignettes/binding-keys.Rmd</code></a></small>
      <div class="d-none name"><code>binding-keys.Rmd</code></div>
    </div>

    
    
<p>When source consists of multiple datasets, binding keys allow to define what relations occur between them. When binding keys are defined, applying filtering on one dataset may result with updating (filtering) the other ones.</p>
<p>To explain how binding keys work and how to define them we’ll be using <code><a href="../reference/librarian.html">cohortBuilder::librarian</a></code> dataset:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">librarian</span><span class="op">)</span>
<span class="co">#&gt; List of 4</span>
<span class="co">#&gt;  $ books    : tibble [17 × 6] (S3: tbl_df/tbl/data.frame)</span>
<span class="co">#&gt;   ..$ isbn     : chr [1:17] "0-385-50420-9" "0-7679-0817-1" "978-0-15-602943-8" "0-224-06252-2" ...</span>
<span class="co">#&gt;   ..$ title    : chr [1:17] "The Da Vinci Code" "A Short History of Nearly Everything" "The Time Traveler's Wife" "Atonement" ...</span>
<span class="co">#&gt;   ..$ genre    : chr [1:17] "Crime, Thriller &amp; Adventure" "Popular Science" "General &amp; Literary Fiction" "General &amp; Literary Fiction" ...</span>
<span class="co">#&gt;   ..$ publisher: chr [1:17] "Transworld" "Transworld" "Random House" "Random House" ...</span>
<span class="co">#&gt;   ..$ author   : chr [1:17] "Dan Brown" "Bill Bryson" "Audrey Niffenegger" "Ian McEwan" ...</span>
<span class="co">#&gt;   ..$ copies   : int [1:17] 7 4 2 8 11 4 9 1 14 11 ...</span>
<span class="co">#&gt;  $ borrowers: tibble [20 × 6] (S3: tbl_df/tbl/data.frame)</span>
<span class="co">#&gt;   ..$ id          : chr [1:20] "000001" "000002" "000003" "000004" ...</span>
<span class="co">#&gt;   ..$ registered  : Date[1:20], format: "2001-06-09" "2002-08-10" ...</span>
<span class="co">#&gt;   ..$ address     : chr [1:20] "66 N. Evergreen Ave. Norristown, PA 19401" "8196 Windsor Road Muscatine, IA 52761" "6 Wood Lane Calumet City, IL 60409" "18 Nut Swamp Road Merrimack, NH 03054" ...</span>
<span class="co">#&gt;   ..$ name        : chr [1:20] "Mrs. Freddie Pouros DDS" "Ms. Jada Lesch" "Inga Dach" "Keyshawn Schaefer" ...</span>
<span class="co">#&gt;   ..$ phone_number: chr [1:20] "626-594-4729" "919-530-5272" "706-669-5694" "746-328-6598" ...</span>
<span class="co">#&gt;   ..$ program     : chr [1:20] "premium" "standard" NA "standard" ...</span>
<span class="co">#&gt;  $ issues   : tibble [50 × 4] (S3: tbl_df/tbl/data.frame)</span>
<span class="co">#&gt;   ..$ id         : chr [1:50] "000001" "000002" "000003" "000004" ...</span>
<span class="co">#&gt;   ..$ borrower_id: chr [1:50] "000019" "000010" "000016" "000005" ...</span>
<span class="co">#&gt;   ..$ isbn       : chr [1:50] "0-676-97976-9" "978-0-7528-6053-4" "0-09-177373-3" "0-224-06252-2" ...</span>
<span class="co">#&gt;   ..$ date       : Date[1:50], format: "2015-03-17" "2008-09-13" ...</span>
<span class="co">#&gt;  $ returns  : tibble [30 × 2] (S3: tbl_df/tbl/data.frame)</span>
<span class="co">#&gt;   ..$ id  : chr [1:30] "000001" "000003" "000004" "000005" ...</span>
<span class="co">#&gt;   ..$ date: Date[1:30], format: "2015-04-06" "2014-10-23" ...</span></code></pre></div>
<p>Let’s say we want to get list of all the library members that borrowed a selected book in 2016.</p>
<p>To start with, we define a Source storing <code>librarian</code> object, create Cohort and configure required filters in it (we choose “Birdsong” book as an example):</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">librarian_source</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_source.html">set_source</a></span><span class="op">(</span>
  <span class="fu"><a href="../reference/tblist.html">as.tblist</a></span><span class="op">(</span><span class="va">librarian</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">librarian_cohort</span> <span class="op">&lt;-</span> <span class="va">librarian_source</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/create-cohort.html">cohort</a></span><span class="op">(</span>
    <span class="fu"><a href="../reference/step.html">step</a></span><span class="op">(</span>
      <span class="fu"><a href="../reference/filter.html">filter</a></span><span class="op">(</span>
        <span class="st">"discrete"</span>, id <span class="op">=</span> <span class="st">"title"</span>, dataset <span class="op">=</span> <span class="st">"books"</span>, 
        variable <span class="op">=</span> <span class="st">"title"</span>, value <span class="op">=</span> <span class="st">"Birdsong"</span>
      <span class="op">)</span>,
      <span class="fu"><a href="../reference/filter.html">filter</a></span><span class="op">(</span>
        <span class="st">"date_range"</span>, id <span class="op">=</span> <span class="st">"issue_date"</span>, dataset <span class="op">=</span> <span class="st">"issues"</span>, 
        variable <span class="op">=</span> <span class="st">"date"</span>, range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2016-01-01"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2016-12-31"</span><span class="op">)</span><span class="op">)</span>
      <span class="op">)</span>
    <span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<p>The above filters cover only part of our case scenario condition:</p>
<ul>
<li>filtering selected book,</li>
<li>filtering all the issues from 2016.</li>
</ul>
<p>Configuring filters for borrowers is impossible - we don’t know upfront which issues were related to the selected book.</p>
<p>How can we overcome the issue?</p>
<div class="section level2">
<h2 id="classic-approach">Classic approach<a class="anchor" aria-label="anchor" href="#classic-approach"></a>
</h2>
<p>With the classic approach, we may iteratively extract each information and extend cohort filters, for example we can define a new condition in the next filtering step:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span><span class="va">librarian_cohort</span><span class="op">)</span>
<span class="va">selected_isbn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_data.html">get_data</a></span><span class="op">(</span><span class="va">librarian_cohort</span><span class="op">)</span><span class="op">$</span><span class="va">books</span><span class="op">$</span><span class="va">isbn</span>
<span class="va">librarian_cohort</span> <span class="op"><a href="../reference/grapes-greater-than-grapes.html">%-&gt;%</a></span> 
  <span class="fu"><a href="../reference/step.html">step</a></span><span class="op">(</span>
    <span class="fu"><a href="../reference/filter.html">filter</a></span><span class="op">(</span><span class="st">"discrete"</span>, id <span class="op">=</span> <span class="st">"isbn"</span>, dataset <span class="op">=</span> <span class="st">"issues"</span>, variable <span class="op">=</span> <span class="st">"isbn"</span>, value <span class="op">=</span> <span class="va">selected_isbn</span><span class="op">)</span>  
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span>step_id <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p>Now <code>librarian_cohort</code> should store all the issues related to selected book. For the final part we need to filter borrowers based on those issues. We’ll do this filtering in the third step:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">selected_borrower_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_data.html">get_data</a></span><span class="op">(</span><span class="va">librarian_cohort</span><span class="op">)</span><span class="op">$</span><span class="va">issues</span><span class="op">$</span><span class="va">borrower_id</span>
<span class="va">librarian_cohort</span> <span class="op"><a href="../reference/grapes-greater-than-grapes.html">%-&gt;%</a></span> 
  <span class="fu"><a href="../reference/step.html">step</a></span><span class="op">(</span>
    <span class="fu"><a href="../reference/filter.html">filter</a></span><span class="op">(</span><span class="st">"discrete"</span>, id <span class="op">=</span> <span class="st">"borr_id"</span>, dataset <span class="op">=</span> <span class="st">"borrowers"</span>, variable <span class="op">=</span> <span class="st">"id"</span>, value <span class="op">=</span> <span class="va">selected_borrower_id</span><span class="op">)</span>  
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span>step_id <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<p>Resulting third-step data should contain desired information:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/get_data.html">get_data</a></span><span class="op">(</span><span class="va">librarian_cohort</span><span class="op">)</span><span class="op">$</span><span class="va">borrowers</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 6</span></span>
<span class="co">#&gt;   id     registered address                           name  phone_number program</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 000009 2007-07-19 9692 E. Fifth Dr. Waterbury, CT … Mari… 669-975-6908 standa…</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 000017 2014-04-07 8501 Lawrence Rd. Terre Haute, I… Rand… 895-995-2326 premium</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="binding-keys">Binding Keys<a class="anchor" aria-label="anchor" href="#binding-keys"></a>
</h2>
<p>Now we’re going to get the same result with using binding-keys.</p>
<p>A single binding key describes relation of specified table, with the other set of tables included in source.</p>
<p><strong>Note.</strong> We relate here to tables, but this can be any other object to which bindings abstraction is valid (i.e. relation between lists).</p>
<p>Let’s define relation between books and issues first and then we’ll explain the syntax:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">issue_books_bk</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binding-keys.html">bind_key</a></span><span class="op">(</span>
  update <span class="op">=</span> <span class="fu"><a href="../reference/data_key.html">data_key</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">"issues"</span>, key <span class="op">=</span> <span class="st">"isbn"</span><span class="op">)</span>,
  <span class="fu"><a href="../reference/data_key.html">data_key</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">"books"</span>, key <span class="op">=</span> <span class="st">"isbn"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>Shortly we should understand this key as:</p>
<p><strong>Whenever table <code>books</code> is filtered, filter <code>issues</code> table as well (by inner join on <code>isbn</code> of both tables)</strong></p>
<p>To make binding keys description easier, let’s name the table passed to <code>update</code> parameter as <strong>dependent</strong> one, and tables defined at <code>...</code> as <strong>triggering</strong> ones.</p>
<p>As we could see above, we define both dependent and triggering tables using data keys (<code>data_key</code>). The first parameter of <code>data_key</code>, <code>dataset</code> stores information about source object name whereas <code>key</code> is a vector of keys used in join.</p>
<p><strong>Note.</strong> We can define only one dependent table in each binding key, but any number of triggering tables (keeping in mind the defined keys are of the same length).</p>
<p><strong>Note.</strong> Dependent table is updated if any of triggering tables changes.</p>
<p><strong>Note.</strong> The triggering table is considered to be <strong>changed</strong> when it has at least active filter attached.</p>
<p><strong>Note.</strong> The <code>dependent</code> table is marked as <strong>changed</strong> when updated (so that can trigger some bindings even if no active filters were attach to it). You may change this behavior by specifying <code>activate = FALSE</code> in <code>bind_key</code>.</p>
<p>No we can define full list of binding keys solving our case. We wrap multiple keys together using <code>bind_keys</code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">case_bks</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binding-keys.html">bind_keys</a></span><span class="op">(</span>
  <span class="fu"><a href="../reference/binding-keys.html">bind_key</a></span><span class="op">(</span>
    update <span class="op">=</span> <span class="fu"><a href="../reference/data_key.html">data_key</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">"issues"</span>, key <span class="op">=</span> <span class="st">"isbn"</span><span class="op">)</span>,
    <span class="fu"><a href="../reference/data_key.html">data_key</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">"books"</span>, key <span class="op">=</span> <span class="st">"isbn"</span><span class="op">)</span>
  <span class="op">)</span>,
  <span class="fu"><a href="../reference/binding-keys.html">bind_key</a></span><span class="op">(</span>
    update <span class="op">=</span> <span class="fu"><a href="../reference/data_key.html">data_key</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">"borrowers"</span>, key <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span>,
    <span class="fu"><a href="../reference/data_key.html">data_key</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">"issues"</span>, key <span class="op">=</span> <span class="st">"borrower_id"</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>We define binding keys while creating source, so we need to:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">librarian_source</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_source.html">set_source</a></span><span class="op">(</span>
  <span class="fu"><a href="../reference/tblist.html">as.tblist</a></span><span class="op">(</span><span class="va">librarian</span><span class="op">)</span>,
  binding_keys <span class="op">=</span> <span class="va">case_bks</span>
<span class="op">)</span>

<span class="va">librarian_cohort</span> <span class="op">&lt;-</span> <span class="va">librarian_source</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/create-cohort.html">cohort</a></span><span class="op">(</span>
    <span class="fu"><a href="../reference/step.html">step</a></span><span class="op">(</span>
      <span class="fu"><a href="../reference/filter.html">filter</a></span><span class="op">(</span>
        <span class="st">"discrete"</span>, id <span class="op">=</span> <span class="st">"title"</span>, dataset <span class="op">=</span> <span class="st">"books"</span>, 
        variable <span class="op">=</span> <span class="st">"title"</span>, value <span class="op">=</span> <span class="st">"Birdsong"</span>
      <span class="op">)</span>,
      <span class="fu"><a href="../reference/filter.html">filter</a></span><span class="op">(</span>
        <span class="st">"date_range"</span>, id <span class="op">=</span> <span class="st">"issue_date"</span>, dataset <span class="op">=</span> <span class="st">"issues"</span>, 
        variable <span class="op">=</span> <span class="st">"date"</span>, range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2016-01-01"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2016-12-31"</span><span class="op">)</span><span class="op">)</span>
      <span class="op">)</span>
    <span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<p>Now:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span><span class="va">librarian_cohort</span><span class="op">)</span>
<span class="fu"><a href="../reference/get_data.html">get_data</a></span><span class="op">(</span><span class="va">librarian_cohort</span><span class="op">)</span>
<span class="co">#&gt; $books</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 6</span></span>
<span class="co">#&gt;   isbn          title    genre                      publisher    author   copies</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 0-09-177373-3 Birdsong General &amp; Literary Fiction Random House Sebasti…      4</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $borrowers</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 6</span></span>
<span class="co">#&gt;   id     registered address                           name  phone_number program</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 000009 2007-07-19 9692 E. Fifth Dr. Waterbury, CT … Mari… 669-975-6908 standa…</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 000017 2014-04-07 8501 Lawrence Rd. Terre Haute, I… Rand… 895-995-2326 premium</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $issues</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 4</span></span>
<span class="co">#&gt;   id     borrower_id isbn          date      </span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 000009 000017      0-09-177373-3 2016-11-12</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 000044 000009      0-09-177373-3 2016-11-20</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $returns</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 30 × 2</span></span>
<span class="co">#&gt;   id     date      </span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 000001 2015-04-06</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 000003 2014-10-23</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 000004 2005-12-29</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 000005 2006-03-26</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 000006 2016-08-30</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 25 more rows</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "tblist"</span>
<span class="co">#&gt; attr(,"call")</span>
<span class="co">#&gt; as.tblist(librarian)</span></code></pre></div>
<p>returns desired result within a single step.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Krystian Igras.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
